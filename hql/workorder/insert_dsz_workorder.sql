-------------------------------------------------------------------------------
-- Query to refresh records into table dsz_mfm_cms.dsz_workorder.
-------------------------------------------------------------------------------

TRUNCATE TABLE dsz_mfm_cms.dsz_workorder;

INSERT INTO dsz_mfm_cms.dsz_workorder SELECT IDWorkOrder, NVL(IDCustomer, CAST(IDCustomer AS INT)), NVL(IDCustomerSegment, CAST(IDCustomerSegment AS INT)), NVL(WONumber, CAST(WONumber AS INT)), WODescription, WORequestComments, WORequestorName, WORequestorPhone, WORequestorEmail, NVL(IDWOCostCenter, CAST(IDWOCostCenter AS INT)), NVL(IDWOPriority, CAST(IDWOPriority AS INT)), NVL(IDWOCategory, CAST(IDWOCategory AS INT)), NVL(IDWOTrade, CAST(IDWOTrade AS INT)), NVL(IDWOLocation, CAST(IDWOLocation AS INT)), LocationOther, NVL(IDWOStatus, CAST(IDWOStatus AS INT)), date_format(WODateAvailable,'yyyy-MM-dd HH:mm:ss'), date_format(WODateNeededBy,'yyyy-MM-dd HH:mm:ss'), date_format(WODateCompleted,'yyyy-MM-dd HH:mm:ss'), WOCompletionComments, NVL(IDPassFail, CAST(IDPassFail AS INT)), IDUserCreated, date_format(DateCreated,'yyyy-MM-dd HH:mm:ss'), IDUserUpdated, date_format(DateUpdated,'yyyy-MM-dd HH:mm:ss'), NVL(SendToPrinter, CAST(SendToPrinter AS INT)), NVL(SendEmail, CAST(SendEmail AS INT)), IDParentWO, AssignmentHierarchy, NVL(AssetCount, CAST(AssetCount AS INT)), NVL(Archived, CAST(Archived AS INT)), IDContract, NVL(IDProblem, CAST(IDProblem AS INT)), SystemOfOrigin, ForeignKey, NVL(XCoord, CAST(XCoord AS DECIMAL(25,10))), NVL(YCoord, CAST(YCoord AS DECIMAL(25,10))), EmailLevel1, EmailLevel2, NVL(IDWOBillableStatus, CAST(IDWOBillableStatus AS INT)), date_format(ScheduledDate,'yyyy-MM-dd HH:mm:ss'), NVL(EstimatedHours, CAST(EstimatedHours AS DECIMAL(25,10))), NVL(P1XCoord, CAST(P1XCoord AS DECIMAL(25,10))), NVL(P1YCoord, CAST(P1YCoord AS DECIMAL(25,10))), NVL(P2XCoord, CAST(P2XCoord AS DECIMAL(25,10))), NVL(P2YCoord, CAST(P2YCoord AS DECIMAL(25,10))), NVL(IsDelete, CAST(IsDelete AS INT)), IDProject, IDUserCompleted, ProcessID, IDRequester, '${processId}', date_format(CURRENT_TIMESTAMP,'yyyy-MM-dd HH:mm:ss') FROM dlz_mfm_cms.dlz_workorder;
