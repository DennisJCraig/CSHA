-------------------------------------------------------------------------------
-- Query to refresh records into table dsz_mfm_cms.dsz_location.
-------------------------------------------------------------------------------

TRUNCATE TABLE dsz_mfm_cms.dsz_location;

INSERT INTO dsz_mfm_cms.dsz_location SELECT NVL(IDLocation, CAST(IDLocation AS INT)), NVL(IDCustomer, CAST(IDCustomer AS INT)), NVL(IDCustomerSegment, CAST(IDCustomerSegment AS INT)), LocationDescription, NVL(LocationVisible, CAST(LocationVisible AS INT)), NVL(LocationSearch, CAST(LocationSearch AS INT)), IDUserCreated, date_format(DateCreated,'yyyy-MM-dd HH:mm:ss'), IDUserUpdated, date_format(DateUpdated,'yyyy-MM-dd HH:mm:ss'), NVL(Level, CAST(Level AS INT)), NVL(IDParent, CAST(IDParent AS INT)), Hierarchy, HierarchyString, ExtendedDescription, SystemOfOrigin, ForeignKey, NVL(InSiteFloor, CAST(InSiteFloor AS INT)), NVL(InSiteRoom, CAST(InSiteRoom AS INT)), InSiteFloorName, InSiteBldgCode, InSiteFloorCode, InSiteBldgFriendlyName, InSiteFloorFriendlyName, NVL(ShowOnlineRequest, CAST(ShowOnlineRequest AS INT)), NVL(SortOrder, CAST(SortOrder AS INT)), IDDrawing, NVL(XCoord, CAST(XCoord AS DECIMAL(25,10))), NVL(YCoord, CAST(YCoord AS DECIMAL(25,10))), NVL(P1XCoord, CAST(P1XCoord AS DECIMAL(25,10))), NVL(P1YCoord, CAST(P1YCoord AS DECIMAL(25,10))), NVL(P2XCoord, CAST(P2XCoord AS DECIMAL(25,10))), NVL(P2YCoord, CAST(P2YCoord AS DECIMAL(25,10))), NVL(IDFloor, CAST(IDFloor AS INT)), NVL(IDCostCenter, CAST(IDCostCenter AS INT)), NVL(IDOccupancy, CAST(IDOccupancy AS INT)), NVL(IDUtilization, CAST(IDUtilization AS INT)), NVL(SQFoot, CAST(SQFoot AS DECIMAL(25,10))), HCOID, '${processId}', date_format(CURRENT_TIMESTAMP,'yyyy-MM-dd HH:mm:ss') FROM dlz_mfm_cms.dlz_location;
